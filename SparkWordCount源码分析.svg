<svg id="SvgjsSvg1006" width="3804.275146484375" height="1358.5250244140625" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1062" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1063" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1078" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1079" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1088" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1089" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1098" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1099" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1102" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1103" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1106" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1107" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1130" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1131" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1134" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1135" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1144" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1145" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1200" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1201" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1220" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1221" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1230" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1231" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1264" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1265" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1278" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1279" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1288" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1289" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1298" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1299" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1318" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1319" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1420" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1421" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1424" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1425" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1428" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1429" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1432" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1433" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1442" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1443" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1446" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1447" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1456" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1457" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1464" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1465" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1468" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1469" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1472" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1473" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1496" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1497" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1508" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1509" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1540" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1541" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1558" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1559" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1576" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1577" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1656" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1657" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1660" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1661" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1670" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1671" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1674" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1675" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1678" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1679" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1682" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1683" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1686" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1687" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1690" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1691" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1710" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1711" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1720" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1721" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1730" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1731" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1734" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1735" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1744" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1745" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1748" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1749" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1752" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1753" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1776" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1777" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1786" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1787" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1794" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1795" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1802" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1803" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(1967.4694203299894,382.46250152587885)"><path id="SvgjsPath1009" d="M 0 0L 1508.333333333333 0L 1508.333333333333 820.1961719921276L 0 820.1961719921276Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffcce6"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="middle" font-size="25px" width="1489px" fill="#323232" font-weight="700" align="top" anchor="middle" family="微软雅黑" size="25px" weight="700" font-style="" opacity="1" y="-5.75" transform="rotate(0)"><tspan id="SvgjsTspan1012" dy="31" x="754.5"><tspan id="SvgjsTspan1013" style="text-decoration:;">shuffleMapTask</tspan></tspan></text></g></g><g id="SvgjsG1014" transform="translate(183.18936665852962,382.9248994769167)"><path id="SvgjsPath1015" d="M 0 0L 1508.333333333333 0L 1508.333333333333 820.1961719921276L 0 820.1961719921276Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffcce6"></path><g id="SvgjsG1016"><text id="SvgjsText1017" font-family="微软雅黑" text-anchor="middle" font-size="25px" width="1489px" fill="#323232" font-weight="700" align="top" anchor="middle" family="微软雅黑" size="25px" weight="700" font-style="" opacity="1" y="-5.75" transform="rotate(0)"><tspan id="SvgjsTspan1018" dy="31" x="754.5"><tspan id="SvgjsTspan1019" style="text-decoration:;">shuffleMapTask</tspan></tspan></text></g></g><g id="SvgjsG1020" transform="translate(226.77083333333331,407.6291681925456)"><path id="SvgjsPath1021" d="M 0 0L 147 0L 147 681.8000106811523L 0 681.8000106811523Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1022"><text id="SvgjsText1023" font-family="微软雅黑" text-anchor="start" font-size="13px" width="127px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.95" transform="rotate(0)"><tspan id="SvgjsTspan1024" dy="16" x="10"><tspan id="SvgjsTspan1025" style="text-decoration:;">HadoopRDD</tspan></tspan><tspan id="SvgjsTspan1026" dy="16" x="10"><tspan id="SvgjsTspan1027" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1028" dy="16" x="10"><tspan id="SvgjsTspan1029" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1030" transform="translate(56.77083333333333,294.62916819254536)"><path id="SvgjsPath1031" d="M 0 0L 710 0L 726 16L 726 74L 0 74L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1032" d="M 710 0L 710 16L 726 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1033" d="M 0 0L 710 0L 726 16L 726 74L 0 74L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1034"><text id="SvgjsText1035" font-family="微软雅黑" text-anchor="start" font-size="13px" width="706px" fill="#323232" font-weight="400" align="middle" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.05" transform="rotate(0)"><tspan id="SvgjsTspan1036" dy="16" x="10"><tspan id="SvgjsTspan1037" style="text-decoration:;">sparkcontext.textFile("data/testdata.txt").flatMap(_.split(" ")).map((_,1)).reduceByKey(_+_).foreach(println)</tspan></tspan><tspan id="SvgjsTspan1038" dy="16" x="10"><tspan id="SvgjsTspan1039" style="text-decoration:;">这个spark完整的一个执行过程，其中有几个问题</tspan></tspan><tspan id="SvgjsTspan1040" dy="16" x="10"><tspan id="SvgjsTspan1041" style="text-decoration:;">1. 数据是怎样在各个算子中流转的</tspan></tspan><tspan id="SvgjsTspan1042" dy="16" x="10"><tspan id="SvgjsTspan1043" style="text-decoration:;">2.我们</tspan></tspan></text></g></g><g id="SvgjsG1044" transform="translate(25.004165649414062,372.2721233105236)"><path id="SvgjsPath1045" d="M 0 0L 104.98888990614168 0L 104.98888990614168 609.6320779647358L 0 609.6320779647358Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1046"><text id="SvgjsText1047" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="85px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="294.8660389823679" transform="rotate(0)"><tspan id="SvgjsTspan1048" dy="16" x="52.5"><tspan id="SvgjsTspan1049" style="text-decoration:;">hdfs文件</tspan></tspan></text></g></g><g id="SvgjsG1050" transform="translate(145.99305555555574,591.3868854678707)"><path id="SvgjsPath1051" d="M 0 0L 254.5 0L 254.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1052"><text id="SvgjsText1053" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.05" transform="rotate(0)"><tspan id="SvgjsTspan1054" dy="16" x="127.5"><tspan id="SvgjsTspan1055" style="text-decoration:;">getPartitions（）</tspan></tspan><tspan id="SvgjsTspan1056" dy="16" x="127.5"><tspan id="SvgjsTspan1057" style="text-decoration:;">getInputFormat(jobConf).getSplits(jo</tspan></tspan><tspan id="SvgjsTspan1058" dy="16" x="127.5"><tspan id="SvgjsTspan1059" style="text-decoration:;">bConf, minPartitions)</tspan></tspan></text></g></g><g id="SvgjsG1060"><path id="SvgjsPath1061" d="M400.49305555555566 620.3868854678703C 425.5262547113914 620.3868854678703 406.41539398381275 565.9958354896972 431.4485931396485 565.9958354896972" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1062)"></path></g><g id="SvgjsG1064" transform="translate(158.65972222222226,944.1847237481004)"><path id="SvgjsPath1065" d="M 0 0L 255.5 0L 255.5 68L 0 68Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1066"><text id="SvgjsText1067" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="236px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.050000000000000044" transform="rotate(0)"><tspan id="SvgjsTspan1068" dy="16" x="128"><tspan id="SvgjsTspan1069" style="text-decoration:;">compute（）</tspan></tspan><tspan id="SvgjsTspan1070" dy="16" x="128"><tspan id="SvgjsTspan1071" style="text-decoration:;">inputFormat.getRecordReader(split.in</tspan></tspan><tspan id="SvgjsTspan1072" dy="16" x="128"><tspan id="SvgjsTspan1073" style="text-decoration:;">putSplit.value, jobConf, </tspan></tspan><tspan id="SvgjsTspan1074" dy="16" x="128"><tspan id="SvgjsTspan1075" style="text-decoration:;">Reporter.NULL)</tspan></tspan></text></g></g><g id="SvgjsG1076"><path id="SvgjsPath1077" d="M414.15972222222223 978.1847237481004C 450.4767232032465 978.1847237481004 479.6552466639775 951.6239482123167 479.6552466639775 915.3069472312923" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1078)"></path></g><g id="SvgjsG1080" transform="translate(248.49305555555566,845.5458348592122)"><path id="SvgjsPath1081" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1082"><text id="SvgjsText1083" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1084" dy="16" x="41.5"><tspan id="SvgjsTspan1085" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1086"><path id="SvgjsPath1087" d="M286.4097222222225 944.1847237481004C 286.4097222222225 921.8892638769926 289.7430555555559 910.8412947303202 289.7430555555559 888.5458348592122" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1088)"></path></g><g id="SvgjsG1090" transform="translate(251.78652221773945,727.0900787345663)"><path id="SvgjsPath1091" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1092"><text id="SvgjsText1093" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1094" dy="16" x="41.5"><tspan id="SvgjsTspan1095" style="text-decoration:;">partition</tspan></tspan></text></g></g><g id="SvgjsG1096"><path id="SvgjsPath1097" d="M273.2430555555556 649.3868854678706C 273.2430555555556 681.460719205292 293.0365222177396 695.0162449971449 293.0365222177396 727.0900787345663" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1098)"></path></g><g id="SvgjsG1100"><path id="SvgjsPath1101" d="M334.2865222177395 748.5900787345663C 364.07061992387526 748.5900787345663 357.21080670602794 695.9958354896967 386.9949044121637 695.9958354896967" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1102)"></path></g><g id="SvgjsG1104"><path id="SvgjsPath1105" d="M158.65972222222226 978.1847237481004C 59.57551103973843 978.1847237481004 293.0365222177397 869.1742899170501 293.0365222177396 770.0900787345663" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1106)"></path><rect id="SvgjsRect1108" width="202" height="16" x="87.69154302654954" y="903.2939804347648" fill="#ffffff"></rect><text id="SvgjsText1109" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="202px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="901.3439804347647" transform="rotate(0)"><tspan id="SvgjsTspan1110" dy="16" x="188.69154302654954"><tspan id="SvgjsTspan1111" style="text-decoration:;">拿着这个文件的index开始迭代计算</tspan></tspan></text></g><g id="SvgjsG1112" transform="translate(719.4313196723843,421.3165409829025)"><path id="SvgjsPath1113" d="M 0 0L 147 0L 147 681.8000106811523L 0 681.8000106811523Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1114"><text id="SvgjsText1115" font-family="微软雅黑" text-anchor="start" font-size="13px" width="127px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.95" transform="rotate(0)"><tspan id="SvgjsTspan1116" dy="16" x="10"><tspan id="SvgjsTspan1117" style="text-decoration:;">MapPartitionsRDD</tspan></tspan><tspan id="SvgjsTspan1118" dy="16" x="10"><tspan id="SvgjsTspan1119" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1120" dy="16" x="10"><tspan id="SvgjsTspan1121" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1122" transform="translate(491.0408925656921,343.46250152587874)"><path id="SvgjsPath1123" d="M 0 0L 168 0L 168 39L 0 39Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1124"><text id="SvgjsText1125" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="148px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.55" transform="rotate(0)"><tspan id="SvgjsTspan1126" dy="16" x="84"><tspan id="SvgjsTspan1127" style="text-decoration:;">flatMap(_.split(" "))</tspan></tspan></text></g></g><g id="SvgjsG1128"><path id="SvgjsPath1129" d="M300.27083333333337 407.6291681925456C 300.2708333333334 329.2574114322137 412.6691358053604 362.9625015258789 491.0408925656921 362.9625015258789" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1130)"></path></g><g id="SvgjsG1132"><path id="SvgjsPath1133" d="M659.0408925656916 362.9625015258789C 717.4625877027065 362.9625015258789 792.9313196723843 362.8948458458875 792.9313196723843 421.3165409829025" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1134)"></path></g><g id="SvgjsG1136" transform="translate(774.6226851851853,538.9439817357948)"><path id="SvgjsPath1137" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ff00"></path><g id="SvgjsG1138"><text id="SvgjsText1139" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1140" dy="16" x="32.5"><tspan id="SvgjsTspan1141" style="text-decoration:;">f</tspan></tspan></text></g></g><g id="SvgjsG1142"><path id="SvgjsPath1143" d="M839.1152598063148 552.1939817357951C 885.4051675136711 552.1939817357951 908.4920187656253 548.5273150691281 954.7819264729816 548.5273150691281" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1144)"></path></g><g id="SvgjsG1146" transform="translate(954.7819264729816,522.2773150691282)"><path id="SvgjsPath1147" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1148" d="M 280.66666666666663 0L 280.66666666666663 16L 296.66666666666663 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1149" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1150"><text id="SvgjsText1151" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="277px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.30000000000000004" transform="rotate(0)"><tspan id="SvgjsTspan1152" dy="16" x="148.5"><tspan id="SvgjsTspan1153" style="text-decoration:;">类的构造方法中传入函数(context, pid, iter) =&gt; </tspan></tspan><tspan id="SvgjsTspan1154" dy="16" x="148.5"><tspan id="SvgjsTspan1155" style="text-decoration:;">iter.flatMap(cleanF)</tspan></tspan><tspan id="SvgjsTspan1156" dy="16" x="148.5"><tspan id="SvgjsTspan1157" style="text-decoration:;">是整个算子的函数处理逻辑</tspan></tspan></text></g></g><g id="SvgjsG1158" transform="translate(431.4485931396485,540.8513904147684)"><path id="SvgjsPath1159" d="M 0 0L 275.6666666666666 0L 291.6666666666666 16L 291.6666666666666 50.288890149857565L 0 50.288890149857565L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1160" d="M 275.6666666666666 0L 275.6666666666666 16L 291.6666666666666 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1161" d="M 0 0L 275.6666666666666 0L 291.6666666666666 16L 291.6666666666666 50.288890149857565L 0 50.288890149857565L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1162"><text id="SvgjsText1163" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="272px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.8055549250712175" transform="rotate(0)"><tspan id="SvgjsTspan1164" dy="16" x="146"><tspan id="SvgjsTspan1165" style="text-decoration:;">1.切割文件找到数据，通过分析它里面的各个方</tspan></tspan><tspan id="SvgjsTspan1166" dy="16" x="146"><tspan id="SvgjsTspan1167" style="text-decoration:;">法，发现如下getPartitions（）方法实现文件</tspan></tspan><tspan id="SvgjsTspan1168" dy="16" x="146"><tspan id="SvgjsTspan1169" style="text-decoration:;">的切割操作</tspan></tspan></text></g></g><g id="SvgjsG1170" transform="translate(386.9949044121637,675.8513904147678)"><path id="SvgjsPath1171" d="M 0 0L 276.49999999999994 0L 292.49999999999994 16L 292.49999999999994 40.28889014985759L 0 40.28889014985759L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1172" d="M 276.49999999999994 0L 276.49999999999994 16L 292.49999999999994 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1173" d="M 0 0L 276.49999999999994 0L 292.49999999999994 16L 292.49999999999994 40.28889014985759L 0 40.28889014985759L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1174"><text id="SvgjsText1175" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="273px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.1944450749287965" transform="rotate(0)"><tspan id="SvgjsTspan1176" dy="16" x="146.5"><tspan id="SvgjsTspan1177" style="text-decoration:;">getPartitions得到的是文件的partition，</tspan></tspan><tspan id="SvgjsTspan1178" dy="16" x="146.5"><tspan id="SvgjsTspan1179" style="text-decoration:;">partition通过源码发现其实就是文件的index</tspan></tspan></text></g></g><g id="SvgjsG1180" transform="translate(335.0952155501763,864.1847237481013)"><path id="SvgjsPath1181" d="M 0 0L 273.12006222760243 0L 289.12006222760243 16L 289.12006222760243 51.12222348319108L 0 51.12222348319108L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1182" d="M 273.12006222760243 0L 273.12006222760243 16L 289.12006222760243 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1183" d="M 0 0L 273.12006222760243 0L 289.12006222760243 16L 289.12006222760243 51.12222348319108L 0 51.12222348319108L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1184"><text id="SvgjsText1185" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="270px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.38888825840446084" transform="rotate(0)"><tspan id="SvgjsTspan1186" dy="16" x="145"><tspan id="SvgjsTspan1187" style="text-decoration:;">2.拿到数据，大数据中数据的迭代都是通过迭</tspan></tspan><tspan id="SvgjsTspan1188" dy="16" x="145"><tspan id="SvgjsTspan1189" style="text-decoration:;">代器完成，发现只有compute方法的返回值是</tspan></tspan><tspan id="SvgjsTspan1190" dy="16" x="145"><tspan id="SvgjsTspan1191" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1192" transform="translate(260.79946963711944,453.70941362263187)"><path id="SvgjsPath1193" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1194"><text id="SvgjsText1195" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1196" dy="16" x="32.5"><tspan id="SvgjsTspan1197" style="text-decoration:;">deps</tspan></tspan></text></g></g><g id="SvgjsG1198"><path id="SvgjsPath1199" d="M260.79946963711944 466.9594136226323C 237.90040137776745 466.9594136226323 230.18099473233377 487.2859570656295 207.28192647298178 487.2859570656295" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1200)"></path></g><g id="SvgjsG1202" transform="translate(108.11525980631508,469.3625005086263)"><path id="SvgjsPath1203" d="M 0 0L 83.16666666666666 0L 99.16666666666666 16L 99.16666666666666 35.8469131140065L 0 35.8469131140065L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1204" d="M 83.16666666666666 0L 83.16666666666666 16L 99.16666666666666 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1205" d="M 0 0L 83.16666666666666 0L 99.16666666666666 16L 99.16666666666666 35.8469131140065L 0 35.8469131140065L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1206"><text id="SvgjsText1207" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.026543442996751265" transform="rotate(0)"><tspan id="SvgjsTspan1208" dy="16" x="50"><tspan id="SvgjsTspan1209" style="text-decoration:;">Nil，表示没</tspan></tspan><tspan id="SvgjsTspan1210" dy="16" x="50"><tspan id="SvgjsTspan1211" style="text-decoration:;">有依赖了</tspan></tspan></text></g></g><g id="SvgjsG1212" transform="translate(756.6850323618196,442.86250050862526)"><path id="SvgjsPath1213" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1214"><text id="SvgjsText1215" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1216" dy="16" x="32.5"><tspan id="SvgjsTspan1217" style="text-decoration:;">pve</tspan></tspan></text></g></g><g id="SvgjsG1218"><path id="SvgjsPath1219" d="M756.6850323618196 456.1125005086257C 603.2378284190996 456.1125005086257 526.562463749035 450.029157002767 373.11525980631507 450.0291570027669" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1220)"></path></g><g id="SvgjsG1222" transform="translate(756.6850323618196,484.04274695596536)"><path id="SvgjsPath1223" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1224"><text id="SvgjsText1225" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1226" dy="16" x="32.5"><tspan id="SvgjsTspan1227" style="text-decoration:;">deps</tspan></tspan></text></g></g><g id="SvgjsG1228"><path id="SvgjsPath1229" d="M756.6850323618196 497.29274695596587C 583.7017863309794 497.29274695596587 498.2752902890892 466.9594136226323 325.292044258249 466.9594136226323" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1230)"></path><rect id="SvgjsRect1232" width="146" height="32" x="467.9885383100343" y="466.1260802892991" fill="#ffffff"></rect><text id="SvgjsText1233" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="146px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="464.17608028929914" transform="rotate(0)"><tspan id="SvgjsTspan1234" dy="16" x="540.9885383100343"><tspan id="SvgjsTspan1235" style="text-decoration:;">OneToOneDependency</tspan></tspan><tspan id="SvgjsTspan1236" dy="16" x="540.9885383100343"><tspan id="SvgjsTspan1237" style="text-decoration:;">1:1的一个依赖，</tspan></tspan></text></g><g id="SvgjsG1238" transform="translate(674.4313196723843,663.9054469799571)"><path id="SvgjsPath1239" d="M 0 0L 254.5 0L 254.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1240"><text id="SvgjsText1241" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.05" transform="rotate(0)"><tspan id="SvgjsTspan1242" dy="16" x="127.5"><tspan id="SvgjsTspan1243" style="text-decoration:;">getPartitions（）</tspan></tspan><tspan id="SvgjsTspan1244" dy="16" x="127.5"><tspan id="SvgjsTspan1245" style="text-decoration:;">firstParent[T].partitions</tspan></tspan></text></g></g><g id="SvgjsG1246" transform="translate(988.1152598063153,600.6723778571613)"><path id="SvgjsPath1247" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1248" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1249" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1250"><text id="SvgjsText1251" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1252" dy="16" x="159"><tspan id="SvgjsTspan1253" style="text-decoration:;">这个算子的getPatitions的实现是直接调用父类的</tspan></tspan><tspan id="SvgjsTspan1254" dy="16" x="159"><tspan id="SvgjsTspan1255" style="text-decoration:;">partitions</tspan></tspan><tspan id="SvgjsTspan1256" dy="16" x="159"><tspan id="SvgjsTspan1257" style="text-decoration:;">这里没有看懂它是怎么处理的？？？</tspan></tspan><tspan id="SvgjsTspan1258" dy="16" x="159"><tspan id="SvgjsTspan1259" style="text-decoration:;">但是通过deps的实现可以推断出它的分区应该是跟</tspan></tspan><tspan id="SvgjsTspan1260" dy="16" x="159"><tspan id="SvgjsTspan1261" style="text-decoration:;">上一个算子有着相同的分区</tspan></tspan></text></g></g><g id="SvgjsG1262"><path id="SvgjsPath1263" d="M801.6813196723843 663.9054469799571C 801.6813196723843 588.9689350245743 913.1787478509323 645.4896625442268 988.1152598063153 645.4896625442268" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1264)"></path></g><g id="SvgjsG1266" transform="translate(661.1813196723843,844.5315471627814)"><path id="SvgjsPath1267" d="M 0 0L 255.5 0L 255.5 68L 0 68Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1268"><text id="SvgjsText1269" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="236px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.05" transform="rotate(0)"><tspan id="SvgjsTspan1270" dy="16" x="128"><tspan id="SvgjsTspan1271" style="text-decoration:;">compute（）</tspan></tspan><tspan id="SvgjsTspan1272" dy="16" x="128"><tspan id="SvgjsTspan1273" style="text-decoration:;">f(context, split.index, </tspan></tspan><tspan id="SvgjsTspan1274" dy="16" x="128"><tspan id="SvgjsTspan1275" style="text-decoration:;">firstParent[T].iterator(split, context))</tspan></tspan></text></g></g><g id="SvgjsG1276"><path id="SvgjsPath1277" d="M774.6226851851853 552.1939817357952C 657.5476738936782 552.1939817357952 788.9313196723843 727.4565358712741 788.9313196723843 844.5315471627814" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1278)"></path><rect id="SvgjsRect1280" width="197" height="32" x="639.3738731944696" y="638.4596352149731" fill="#ffffff"></rect><text id="SvgjsText1281" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="197px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="636.5096352149731" transform="rotate(0)"><tspan id="SvgjsTspan1282" dy="16" x="737.8738731944696"><tspan id="SvgjsTspan1283" style="text-decoration:;">作用在compute上</tspan></tspan><tspan id="SvgjsTspan1284" dy="16" x="737.8738731944696"><tspan id="SvgjsTspan1285" style="text-decoration:;">调用Scala底层的flatMap函数实现</tspan></tspan></text></g><g id="SvgjsG1286"><path id="SvgjsPath1287" d="M788.9313196723843 912.5315471627814C 788.9313196723843 947.9582771327662 788.9313196723843 965.6716421177584 788.9313196723843 1001.0983720877432" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1288)"></path></g><g id="SvgjsG1290" transform="translate(747.6813196723843,1001.0983720877432)"><path id="SvgjsPath1291" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1292"><text id="SvgjsText1293" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1294" dy="16" x="41.5"><tspan id="SvgjsTspan1295" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1296"><path id="SvgjsPath1297" d="M289.7430555555557 845.5458348592122C 289.74305555555577 644.0807972234816 788.9313196723843 1113.9965847985118 788.9313196723843 912.5315471627814" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1298)"></path><rect id="SvgjsRect1300" width="143" height="16" x="430.5228648712372" y="841.2351398062854" fill="#ffffff"></rect><text id="SvgjsText1301" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="143px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="839.2851398062853" transform="rotate(0)"><tspan id="SvgjsTspan1302" dy="16" x="502.0228648712372"><tspan id="SvgjsTspan1303" style="text-decoration:;">拿到上一个算子的迭代器</tspan></tspan></text></g><g id="SvgjsG1304" transform="translate(992.2819264729819,825.81126674605)"><path id="SvgjsPath1305" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1306" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1307" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1308"><text id="SvgjsText1309" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="18.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1310" dy="16" x="159"><tspan id="SvgjsTspan1311" style="text-decoration:;">整个方法是调用构造函数中的f函数</tspan></tspan><tspan id="SvgjsTspan1312" dy="16" x="159"><tspan id="SvgjsTspan1313" style="text-decoration:;">注意最后的fistParent.iterator传的是上一个算子的</tspan></tspan><tspan id="SvgjsTspan1314" dy="16" x="159"><tspan id="SvgjsTspan1315" style="text-decoration:;">迭代器</tspan></tspan></text></g></g><g id="SvgjsG1316"><path id="SvgjsPath1317" d="M916.6813196723843 878.5315471627814C 947.0863431786977 878.5315471627814 961.8769029666686 870.6285514331157 992.2819264729819 870.6285514331157" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1318)"></path></g><g id="SvgjsG1320" transform="translate(1397.8089098910725,388.8793678063154)"><path id="SvgjsPath1321" d="M 0 0L 147 0L 147 681.8000106811523L 0 681.8000106811523Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1322"><text id="SvgjsText1323" font-family="微软雅黑" text-anchor="start" font-size="13px" width="127px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.95" transform="rotate(0)"><tspan id="SvgjsTspan1324" dy="16" x="10"><tspan id="SvgjsTspan1325" style="text-decoration:;">MapPartitionsRDD</tspan></tspan><tspan id="SvgjsTspan1326" dy="16" x="10"><tspan id="SvgjsTspan1327" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1328" dy="16" x="10"><tspan id="SvgjsTspan1329" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1330" transform="translate(1434.1782576949513,516.4280555277398)"><path id="SvgjsPath1331" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ff00"></path><g id="SvgjsG1332"><text id="SvgjsText1333" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1334" dy="16" x="32.5"><tspan id="SvgjsTspan1335" style="text-decoration:;">f</tspan></tspan></text></g></g><g id="SvgjsG1336" transform="translate(1595.2286759480996,486.4439817357948)"><path id="SvgjsPath1337" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1338" d="M 280.66666666666663 0L 280.66666666666663 16L 296.66666666666663 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1339" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1340"><text id="SvgjsText1341" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="277px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.30000000000000004" transform="rotate(0)"><tspan id="SvgjsTspan1342" dy="16" x="148.5"><tspan id="SvgjsTspan1343" style="text-decoration:;">类的构造方法中传入函数(context, pid, iter) =&gt; </tspan></tspan><tspan id="SvgjsTspan1344" dy="16" x="148.5"><tspan id="SvgjsTspan1345" style="text-decoration:;">iter.map(cleanF)</tspan></tspan><tspan id="SvgjsTspan1346" dy="16" x="148.5"><tspan id="SvgjsTspan1347" style="text-decoration:;">是整个算子的函数处理逻辑</tspan></tspan></text></g></g><g id="SvgjsG1348" transform="translate(1444.541640824455,406.92536016387675)"><path id="SvgjsPath1349" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1350"><text id="SvgjsText1351" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1352" dy="16" x="32.5"><tspan id="SvgjsTspan1353" style="text-decoration:;">pve</tspan></tspan></text></g></g><g id="SvgjsG1354" transform="translate(1441.355042146885,453.4203193609597)"><path id="SvgjsPath1355" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1356"><text id="SvgjsText1357" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1358" dy="16" x="32.5"><tspan id="SvgjsTspan1359" style="text-decoration:;">deps</tspan></tspan></text></g></g><g id="SvgjsG1360" transform="translate(1374.167031333156,646.5980480485)"><path id="SvgjsPath1361" d="M 0 0L 254.5 0L 254.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1362"><text id="SvgjsText1363" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.05" transform="rotate(0)"><tspan id="SvgjsTspan1364" dy="16" x="127.5"><tspan id="SvgjsTspan1365" style="text-decoration:;">getPartitions（）</tspan></tspan><tspan id="SvgjsTspan1366" dy="16" x="127.5"><tspan id="SvgjsTspan1367" style="text-decoration:;">firstParent[T].partitions</tspan></tspan></text></g></g><g id="SvgjsG1368" transform="translate(1662.8374989827478,561.5845853317591)"><path id="SvgjsPath1369" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1370" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1371" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1372"><text id="SvgjsText1373" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1374" dy="16" x="159"><tspan id="SvgjsTspan1375" style="text-decoration:;">这个算子的getPatitions的实现是直接调用父类的</tspan></tspan><tspan id="SvgjsTspan1376" dy="16" x="159"><tspan id="SvgjsTspan1377" style="text-decoration:;">partitions</tspan></tspan><tspan id="SvgjsTspan1378" dy="16" x="159"><tspan id="SvgjsTspan1379" style="text-decoration:;">这里没有看懂它是怎么处理的？？？</tspan></tspan><tspan id="SvgjsTspan1380" dy="16" x="159"><tspan id="SvgjsTspan1381" style="text-decoration:;">但是通过deps的实现可以推断出它的分区应该是跟</tspan></tspan><tspan id="SvgjsTspan1382" dy="16" x="159"><tspan id="SvgjsTspan1383" style="text-decoration:;">上一个算子有着相同的分区</tspan></tspan></text></g></g><g id="SvgjsG1384" transform="translate(1367.3416051243103,811.2663863215423)"><path id="SvgjsPath1385" d="M 0 0L 255.5 0L 255.5 68L 0 68Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1386"><text id="SvgjsText1387" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="236px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.05" transform="rotate(0)"><tspan id="SvgjsTspan1388" dy="16" x="128"><tspan id="SvgjsTspan1389" style="text-decoration:;">compute（）</tspan></tspan><tspan id="SvgjsTspan1390" dy="16" x="128"><tspan id="SvgjsTspan1391" style="text-decoration:;">f(context, split.index, </tspan></tspan><tspan id="SvgjsTspan1392" dy="16" x="128"><tspan id="SvgjsTspan1393" style="text-decoration:;">firstParent[T].iterator(split, context))</tspan></tspan></text></g></g><g id="SvgjsG1394" transform="translate(1453.535210547605,959.5736126369895)"><path id="SvgjsPath1395" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1396"><text id="SvgjsText1397" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1398" dy="16" x="41.5"><tspan id="SvgjsTspan1399" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1400" transform="translate(1692.0041656494145,792.189503024962)"><path id="SvgjsPath1401" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1402" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1403" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1404"><text id="SvgjsText1405" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="18.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1406" dy="16" x="159"><tspan id="SvgjsTspan1407" style="text-decoration:;">整个方法是调用构造函数中的f函数</tspan></tspan><tspan id="SvgjsTspan1408" dy="16" x="159"><tspan id="SvgjsTspan1409" style="text-decoration:;">注意最后的fistParent.iterator传的是上一个算子的</tspan></tspan><tspan id="SvgjsTspan1410" dy="16" x="159"><tspan id="SvgjsTspan1411" style="text-decoration:;">迭代器</tspan></tspan></text></g></g><g id="SvgjsG1412" transform="translate(1046.5964481212472,294.0389022362734)"><path id="SvgjsPath1413" d="M 0 0L 168 0L 168 39L 0 39Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1414"><text id="SvgjsText1415" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="148px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.55" transform="rotate(0)"><tspan id="SvgjsTspan1416" dy="16" x="84"><tspan id="SvgjsTspan1417" style="text-decoration:;">map((_,1))</tspan></tspan></text></g></g><g id="SvgjsG1418"><path id="SvgjsPath1419" d="M792.9313196723843 421.3165409829025C 792.9313196723843 311.0717103160437 936.3516174543888 313.53890223627343 1046.5964481212472 313.53890223627343" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1420)"></path></g><g id="SvgjsG1422"><path id="SvgjsPath1423" d="M1214.596448121248 313.53890223627343C 1321.6123151916852 313.5389022362734 1471.3089098910725 281.86350073587795 1471.3089098910725 388.8793678063154" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1424)"></path></g><g id="SvgjsG1426"><path id="SvgjsPath1427" d="M1444.541640824455 420.1753601638771C 1212.6911948475615 420.1753601638771 1098.005853964888 458.0672958266984 866.1554079879943 458.0672958266985" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1428)"></path></g><g id="SvgjsG1430"><path id="SvgjsPath1431" d="M1441.355042146885 466.67031936096026C 1192.9818441859684 466.67031936096026 1069.5508049438658 497.29274695596587 821.1776069829491 497.29274695596587" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1432)"></path><rect id="SvgjsRect1434" width="146" height="32" x="1058.266324564917" y="465.98153315846304" fill="#ffffff"></rect><text id="SvgjsText1435" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="146px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="464.03153315846305" transform="rotate(0)"><tspan id="SvgjsTspan1436" dy="16" x="1131.266324564917"><tspan id="SvgjsTspan1437" style="text-decoration:;">OneToOneDependency</tspan></tspan><tspan id="SvgjsTspan1438" dy="16" x="1131.266324564917"><tspan id="SvgjsTspan1439" style="text-decoration:;">1:1的一个依赖，</tspan></tspan></text></g><g id="SvgjsG1440"><path id="SvgjsPath1441" d="M1498.6708323160808 529.6780555277402C 1537.8869023475067 529.6780555277402 1556.0126059166737 512.6939817357948 1595.2286759480996 512.6939817357948" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1442)"></path></g><g id="SvgjsG1444"><path id="SvgjsPath1445" d="M1434.1782576949513 529.6780555277402C 1318.9376926603838 529.6780555277402 1495.0916051243103 696.0258212869749 1495.0916051243103 811.2663863215423" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1446)"></path><rect id="SvgjsRect1448" width="197" height="32" x="1299.6811182261151" y="573.7206681876681" fill="#ffffff"></rect><text id="SvgjsText1449" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="197px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="571.7706681876681" transform="rotate(0)"><tspan id="SvgjsTspan1450" dy="16" x="1398.1811182261151"><tspan id="SvgjsTspan1451" style="text-decoration:;">作用在compute上</tspan></tspan><tspan id="SvgjsTspan1452" dy="16" x="1398.1811182261151"><tspan id="SvgjsTspan1453" style="text-decoration:;">调用Scala底层的flatMap函数实现</tspan></tspan></text></g><g id="SvgjsG1454"><path id="SvgjsPath1455" d="M788.9313196723843 1044.0983720877432C 788.9313196723843 1334.1554512376724 1313.9708302815757 1027.895838419596 1495.0916051243103 879.2663863215423" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1456)"></path><rect id="SvgjsRect1458" width="143" height="16" x="1002.5911718323218" y="1118.1898284226363" fill="#ffffff"></rect><text id="SvgjsText1459" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="143px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="1116.2398284226363" transform="rotate(0)"><tspan id="SvgjsTspan1460" dy="16" x="1074.0911718323218"><tspan id="SvgjsTspan1461" style="text-decoration:;">拿到上一个算子的迭代器</tspan></tspan></text></g><g id="SvgjsG1462"><path id="SvgjsPath1463" d="M1495.0916051243103 879.2663863215423C 1495.0916051243103 911.3895106431075 1494.785210547605 927.4504883154243 1494.785210547605 959.5736126369895" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1464)"></path></g><g id="SvgjsG1466"><path id="SvgjsPath1467" d="M1622.8416051243103 845.2663863215423C 1650.7032080863196 845.2663863215423 1664.1425626874052 837.0067877120277 1692.0041656494145 837.0067877120277" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1468)"></path></g><g id="SvgjsG1470"><path id="SvgjsPath1471" d="M1501.417031333156 646.5980480485C 1501.417031333156 580.0580749743774 1596.297525908625 606.4018700188246 1662.8374989827478 606.4018700188246" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1472)"></path></g><g id="SvgjsG1474" transform="translate(2126.68031398325,421.3165409829024)"><path id="SvgjsPath1475" d="M 0 0L 147 0L 147 681.8000106811523L 0 681.8000106811523Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1476"><text id="SvgjsText1477" font-family="微软雅黑" text-anchor="start" font-size="13px" width="127px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.95" transform="rotate(0)"><tspan id="SvgjsTspan1478" dy="16" x="10"><tspan id="SvgjsTspan1479" style="text-decoration:;">ShuffledRDD</tspan></tspan><tspan id="SvgjsTspan1480" dy="16" x="10"><tspan id="SvgjsTspan1481" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1482" transform="translate(2168.7083074911216,448.1399633896313)"><path id="SvgjsPath1483" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1484"><text id="SvgjsText1485" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1486" dy="16" x="32.5"><tspan id="SvgjsTspan1487" style="text-decoration:;">pve</tspan></tspan></text></g></g><g id="SvgjsG1488" transform="translate(2174.5416408244546,499.51810123012046)"><path id="SvgjsPath1489" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1490"><text id="SvgjsText1491" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1492" dy="16" x="32.5"><tspan id="SvgjsTspan1493" style="text-decoration:;">deps</tspan></tspan></text></g></g><g id="SvgjsG1494"><path id="SvgjsPath1495" d="M2168.7083074911216 461.38996338963176C 1918.62242382492 461.38996338963176 1794.2567464998608 432.2967893167782 1544.1708628336587 432.2967893167781" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1496)"></path><rect id="SvgjsRect1498" width="156" height="48" x="1778.4395851623901" y="422.8433763532049" fill="#ffffff"></rect><text id="SvgjsText1499" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="156px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="420.8933763532049" transform="rotate(0)"><tspan id="SvgjsTspan1500" dy="16" x="1856.4395851623901"><tspan id="SvgjsTspan1501" style="text-decoration:;">@transient</tspan></tspan><tspan id="SvgjsTspan1502" dy="16" x="1856.4395851623901"><tspan id="SvgjsTspan1503" style="text-decoration:;">表示之前的数据不要序列化</tspan></tspan><tspan id="SvgjsTspan1504" dy="16" x="1856.4395851623901"><tspan id="SvgjsTspan1505" style="text-decoration:;">不要重新跑任务拿到数据</tspan></tspan></text></g><g id="SvgjsG1506"><path id="SvgjsPath1507" d="M2174.5416408244546 512.7681012301209C 2137.3437907531297 512.7681012301209 2118.7826719388895 515.2989611765154 2081.7263709174244 518.5409674280977" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1508)"></path></g><g id="SvgjsG1510" transform="translate(1982.5597042507577,500.6175108710945)"><path id="SvgjsPath1511" d="M 0 0L 83.16666666666666 0L 99.16666666666666 16L 99.16666666666666 35.8469131140065L 0 35.8469131140065L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1512" d="M 83.16666666666666 0L 83.16666666666666 16L 99.16666666666666 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1513" d="M 0 0L 83.16666666666666 0L 99.16666666666666 16L 99.16666666666666 35.8469131140065L 0 35.8469131140065L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1514"><text id="SvgjsText1515" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-0.026543442996751265" transform="rotate(0)"><tspan id="SvgjsTspan1516" dy="16" x="50"><tspan id="SvgjsTspan1517" style="text-decoration:;">Nil，表示没</tspan></tspan><tspan id="SvgjsTspan1518" dy="16" x="50"><tspan id="SvgjsTspan1519" style="text-decoration:;">有前置依赖了</tspan></tspan></text></g></g><g id="SvgjsG1520" transform="translate(2079.615000890264,655.7656965574204)"><path id="SvgjsPath1521" d="M 0 0L 254.5 0L 254.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1522"><text id="SvgjsText1523" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="19.05" transform="rotate(0)"><tspan id="SvgjsTspan1524" dy="16" x="127.5"><tspan id="SvgjsTspan1525" style="text-decoration:;">getDependencies()</tspan></tspan></text></g></g><g id="SvgjsG1526" transform="translate(2321.895342614764,582.278296911382)"><path id="SvgjsPath1527" d="M 0 0L 422.6089349324361 0L 438.6089349324361 16L 438.6089349324361 52.75184193363859L 0 52.75184193363859L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1528" d="M 422.6089349324361 0L 422.6089349324361 16L 438.6089349324361 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1529" d="M 0 0L 422.6089349324361 0L 438.6089349324361 16L 438.6089349324361 52.75184193363859L 0 52.75184193363859L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1530"><text id="SvgjsText1531" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="419px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.4259209668192938" transform="rotate(0)"><tspan id="SvgjsTspan1532" dy="16" x="219.5"><tspan id="SvgjsTspan1533" style="text-decoration:;">List(new ShuffleDependency(prev, part, serializer, keyOrdering, </tspan></tspan><tspan id="SvgjsTspan1534" dy="16" x="219.5"><tspan id="SvgjsTspan1535" style="text-decoration:;">aggregator, mapSideCombine))</tspan></tspan><tspan id="SvgjsTspan1536" dy="16" x="219.5"><tspan id="SvgjsTspan1537" style="text-decoration:;">通过上面的入参，得到整个shuffled所需要的所有的数据</tspan></tspan></text></g></g><g id="SvgjsG1538"><path id="SvgjsPath1539" d="M2334.115000890264 684.7656965574204C 2419.3044311252597 684.7656965574204 2541.1998100809824 720.2195690800156 2541.1998100809824 635.0301388450202" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1540)"></path></g><g id="SvgjsG1542" transform="translate(2096.0400717273974,845.4340348304629)"><path id="SvgjsPath1543" d="M 0 0L 247.29745777292715 0L 247.29745777292715 97.59612181647782L 0 97.59612181647782Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1544"><text id="SvgjsText1545" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="228px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.848060908238909" transform="rotate(0)"><tspan id="SvgjsTspan1546" dy="16" x="124"><tspan id="SvgjsTspan1547" style="text-decoration:;">compute（）</tspan></tspan><tspan id="SvgjsTspan1548" dy="16" x="124"><tspan id="SvgjsTspan1549" style="text-decoration:;">shuffleManager.getReader(dep.shuff</tspan></tspan><tspan id="SvgjsTspan1550" dy="16" x="124"><tspan id="SvgjsTspan1551" style="text-decoration:;">leHandle, split.index, split.index + 1, </tspan></tspan><tspan id="SvgjsTspan1552" dy="16" x="124"><tspan id="SvgjsTspan1553" style="text-decoration:;">context)</tspan></tspan><tspan id="SvgjsTspan1554" dy="16" x="124"><tspan id="SvgjsTspan1555" style="text-decoration:;">      .read()</tspan></tspan></text></g></g><g id="SvgjsG1556"><path id="SvgjsPath1557" d="M2219.688800613862 943.0301566469407C 2219.688800613862 967.9336752378654 2219.8001236999953 980.3853350065128 2219.8001236999953 1005.2888535974375" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1558)"></path></g><g id="SvgjsG1560" transform="translate(2178.5501236999953,1005.2888535974375)"><path id="SvgjsPath1561" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1562"><text id="SvgjsText1563" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1564" dy="16" x="41.5"><tspan id="SvgjsTspan1565" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1566" transform="translate(2303.5620092814306,777.6121476238241)"><path id="SvgjsPath1567" d="M 0 0L 422.6089349324361 0L 438.6089349324361 16L 438.6089349324361 52.75184193363859L 0 52.75184193363859L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1568" d="M 422.6089349324361 0L 422.6089349324361 16L 438.6089349324361 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1569" d="M 0 0L 422.6089349324361 0L 438.6089349324361 16L 438.6089349324361 52.75184193363859L 0 52.75184193363859L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1570"><text id="SvgjsText1571" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="419px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="16.425920966819294" transform="rotate(0)"><tspan id="SvgjsTspan1572" dy="16" x="219.5"><tspan id="SvgjsTspan1573" style="text-decoration:;">通过shuffleManager得到一个reader，从而拿到需要的数据</tspan></tspan></text></g></g><g id="SvgjsG1574"><path id="SvgjsPath1575" d="M2343.337529500325 894.2320957387019C 2419.5580284616 894.2320957387019 2522.8664767476484 906.5844885187371 2522.8664767476484 830.3639895574627" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1576)"></path></g><g id="SvgjsG1578" transform="translate(2754.3644315382066,421.3165409829025)"><path id="SvgjsPath1579" d="M 0 0L 147 0L 147 681.8000106811523L 0 681.8000106811523Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1580"><text id="SvgjsText1581" font-family="微软雅黑" text-anchor="start" font-size="13px" width="127px" fill="#323232" font-weight="400" align="top" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.95" transform="rotate(0)"><tspan id="SvgjsTspan1582" dy="16" x="10"><tspan id="SvgjsTspan1583" style="text-decoration:;">MapPartitionsRDD</tspan></tspan><tspan id="SvgjsTspan1584" dy="16" x="10"><tspan id="SvgjsTspan1585" style="text-decoration:;"> </tspan></tspan><tspan id="SvgjsTspan1586" dy="16" x="10"><tspan id="SvgjsTspan1587" style="text-decoration:;"> </tspan></tspan></text></g></g><g id="SvgjsG1588" transform="translate(2798.7154294678066,553.149697657513)"><path id="SvgjsPath1589" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ff00"></path><g id="SvgjsG1590"><text id="SvgjsText1591" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1592" dy="16" x="32.5"><tspan id="SvgjsTspan1593" style="text-decoration:;">f</tspan></tspan></text></g></g><g id="SvgjsG1594" transform="translate(2952.4508642619003,527.9687411865486)"><path id="SvgjsPath1595" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1596" d="M 280.66666666666663 0L 280.66666666666663 16L 296.66666666666663 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1597" d="M 0 0L 280.66666666666663 0L 296.66666666666663 16L 296.66666666666663 52.5L 0 52.5L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1598"><text id="SvgjsText1599" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="277px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="0.30000000000000004" transform="rotate(0)"><tspan id="SvgjsTspan1600" dy="16" x="148.5"><tspan id="SvgjsTspan1601" style="text-decoration:;">类的构造方法中传入函数(context, pid, iter) =&gt; </tspan></tspan><tspan id="SvgjsTspan1602" dy="16" x="148.5"><tspan id="SvgjsTspan1603" style="text-decoration:;">iter.map(cleanF)</tspan></tspan><tspan id="SvgjsTspan1604" dy="16" x="148.5"><tspan id="SvgjsTspan1605" style="text-decoration:;">是整个算子的函数处理逻辑</tspan></tspan></text></g></g><g id="SvgjsG1606" transform="translate(2803.4304958049224,444.3369410210077)"><path id="SvgjsPath1607" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1608"><text id="SvgjsText1609" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1610" dy="16" x="32.5"><tspan id="SvgjsTspan1611" style="text-decoration:;">pve</tspan></tspan></text></g></g><g id="SvgjsG1612" transform="translate(2791.9787534056127,502.99880590740304)"><path id="SvgjsPath1613" d="M 0 0L 64.4925746211295 0L 64.4925746211295 26.50000000000091L 0 26.50000000000091Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1614"><text id="SvgjsText1615" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="45px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="3.3000000000004546" transform="rotate(0)"><tspan id="SvgjsTspan1616" dy="16" x="32.5"><tspan id="SvgjsTspan1617" style="text-decoration:;">deps</tspan></tspan></text></g></g><g id="SvgjsG1618" transform="translate(2736.126134750536,687.3461674359094)"><path id="SvgjsPath1619" d="M 0 0L 254.5 0L 254.5 58L 0 58Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1620"><text id="SvgjsText1621" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="235px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.05" transform="rotate(0)"><tspan id="SvgjsTspan1622" dy="16" x="127.5"><tspan id="SvgjsTspan1623" style="text-decoration:;">getPartitions（）</tspan></tspan><tspan id="SvgjsTspan1624" dy="16" x="127.5"><tspan id="SvgjsTspan1625" style="text-decoration:;">firstParent[T].partitions</tspan></tspan></text></g></g><g id="SvgjsG1626" transform="translate(2724.563793438111,852.791145772296)"><path id="SvgjsPath1627" d="M 0 0L 255.5 0L 255.5 68L 0 68Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ff6666"></path><g id="SvgjsG1628"><text id="SvgjsText1629" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="236px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="8.05" transform="rotate(0)"><tspan id="SvgjsTspan1630" dy="16" x="128"><tspan id="SvgjsTspan1631" style="text-decoration:;">compute（）</tspan></tspan><tspan id="SvgjsTspan1632" dy="16" x="128"><tspan id="SvgjsTspan1633" style="text-decoration:;">f(context, split.index, </tspan></tspan><tspan id="SvgjsTspan1634" dy="16" x="128"><tspan id="SvgjsTspan1635" style="text-decoration:;">firstParent[T].iterator(split, context))</tspan></tspan></text></g></g><g id="SvgjsG1636" transform="translate(2810.757398861406,1001.0983720877432)"><path id="SvgjsPath1637" d="M 0 0L 82.5 0L 82.5 43L 0 43Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#00ffff"></path><g id="SvgjsG1638"><text id="SvgjsText1639" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="63px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.55" transform="rotate(0)"><tspan id="SvgjsTspan1640" dy="16" x="41.5"><tspan id="SvgjsTspan1641" style="text-decoration:;">iterator</tspan></tspan></text></g></g><g id="SvgjsG1642" transform="translate(3049.226353963215,833.7142624757157)"><path id="SvgjsPath1643" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1644" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1645" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1646"><text id="SvgjsText1647" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="18.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1648" dy="16" x="159"><tspan id="SvgjsTspan1649" style="text-decoration:;">整个方法是调用构造函数中的f函数</tspan></tspan><tspan id="SvgjsTspan1650" dy="16" x="159"><tspan id="SvgjsTspan1651" style="text-decoration:;">注意最后的fistParent.iterator传的是上一个算子的</tspan></tspan><tspan id="SvgjsTspan1652" dy="16" x="159"><tspan id="SvgjsTspan1653" style="text-decoration:;">迭代器</tspan></tspan></text></g></g><g id="SvgjsG1654"><path id="SvgjsPath1655" d="M2803.4304958049224 457.58694102100804C 2591.4817956197635 457.58694102100804 2485.5084993794944 456.53014774598086 2273.5597991943355 456.53014774598097" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1656)"></path></g><g id="SvgjsG1658"><path id="SvgjsPath1659" d="M2791.9787534056127 516.2488059074035C 2570.7965561600367 516.2488059074035 2460.21641269116 512.7681012301207 2239.034215445584 512.7681012301209" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1660)"></path><rect id="SvgjsRect1662" width="146" height="32" x="2442.506484425598" y="498.5084535687621" fill="#ffffff"></rect><text id="SvgjsText1663" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="146px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="496.5584535687621" transform="rotate(0)"><tspan id="SvgjsTspan1664" dy="16" x="2515.506484425598"><tspan id="SvgjsTspan1665" style="text-decoration:;">OneToOneDependency</tspan></tspan><tspan id="SvgjsTspan1666" dy="16" x="2515.506484425598"><tspan id="SvgjsTspan1667" style="text-decoration:;">1:1的一个依赖，</tspan></tspan></text></g><g id="SvgjsG1668"><path id="SvgjsPath1669" d="M2990.626134750536 716.3461674359094C 3080.638128196002 716.3461674359094 3215.5874379475913 811.9174404254231 3215.5874379475913 721.9054469799571" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1670)"></path></g><g id="SvgjsG1672"><path id="SvgjsPath1673" d="M2852.313793438111 920.791145772296C 2852.313793438111 1001.34962655955 2968.6678731759607 878.5315471627814 3049.226353963215 878.5315471627814" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1674)"></path></g><g id="SvgjsG1676"><path id="SvgjsPath1677" d="M2219.8001236999953 1048.2888535974375C 2219.8001236999953 1306.3831643929284 2648.893152872721 1014.5857138979172 2852.313793438111 920.791145772296" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1678)"></path></g><g id="SvgjsG1680"><path id="SvgjsPath1681" d="M2852.313793438111 920.791145772296C 2852.313793438111 952.9142700938612 2852.007398861406 968.975247766178 2852.007398861406 1001.0983720877432" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1682)"></path></g><g id="SvgjsG1684"><path id="SvgjsPath1685" d="M2863.208004088936 566.3996976575133C 2899.2361348589857 566.3996976575133 2916.4227334918505 554.2187411865485 2952.4508642619003 554.2187411865485" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1686)"></path></g><g id="SvgjsG1688"><path id="SvgjsPath1689" d="M2798.7154294678066 566.3996976575133C 2682.169921670328 566.3996976575133 2852.313793438111 736.2456379748176 2852.313793438111 852.791145772296" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1690)"></path></g><g id="SvgjsG1692" transform="translate(3056.8374379475913,632.270877605826)"><path id="SvgjsPath1693" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1694" d="M 301.49999999999966 0L 301.49999999999966 16L 317.49999999999966 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1695" d="M 0 0L 301.49999999999966 0L 317.49999999999966 16L 317.49999999999966 89.63456937413116L 0 89.63456937413116L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1696"><text id="SvgjsText1697" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="298px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.86728468706558" transform="rotate(0)"><tspan id="SvgjsTspan1698" dy="16" x="159"><tspan id="SvgjsTspan1699" style="text-decoration:;">这个算子的getPatitions的实现是直接调用父类的</tspan></tspan><tspan id="SvgjsTspan1700" dy="16" x="159"><tspan id="SvgjsTspan1701" style="text-decoration:;">partitions</tspan></tspan><tspan id="SvgjsTspan1702" dy="16" x="159"><tspan id="SvgjsTspan1703" style="text-decoration:;">这里没有看懂它是怎么处理的？？？</tspan></tspan><tspan id="SvgjsTspan1704" dy="16" x="159"><tspan id="SvgjsTspan1705" style="text-decoration:;">但是通过deps的实现可以推断出它的分区应该是跟</tspan></tspan><tspan id="SvgjsTspan1706" dy="16" x="159"><tspan id="SvgjsTspan1707" style="text-decoration:;">上一个算子有着相同的分区</tspan></tspan></text></g></g><g id="SvgjsG1708"><path id="SvgjsPath1709" d="M1491.0596974690754 475.8069356282552C 1491.0596974690754 478.788359598255 1487.0596974690754 477.8069356282552 1484.3930308024087 479.14026896158856" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1710)"></path></g><g id="SvgjsG1712" transform="translate(1679.6520036768031,153.11297631034753)"><path id="SvgjsPath1713" d="M 0 0L 168 0L 168 39L 0 39Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1714"><text id="SvgjsText1715" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="148px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.55" transform="rotate(0)"><tspan id="SvgjsTspan1716" dy="16" x="84"><tspan id="SvgjsTspan1717" style="text-decoration:;">reduceByKey(_+_)</tspan></tspan></text></g></g><g id="SvgjsG1718"><path id="SvgjsPath1719" d="M1471.3089098910725 388.8793678063154C 1471.3089098910725 268.76076187441345 1559.5333977449013 172.6129763103475 1679.6520036768031 172.6129763103475" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1720)"></path></g><g id="SvgjsG1722" transform="translate(1650.4853370101366,252.5574207547919)"><path id="SvgjsPath1723" d="M 0 0L 384.1299634862826 0L 384.1299634862826 54.5828532930595L 0 54.5828532930595Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1724"><text id="SvgjsText1725" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="365px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="17.34142664652975" transform="rotate(0)"><tspan id="SvgjsTspan1726" dy="16" x="192.5"><tspan id="SvgjsTspan1727" style="text-decoration:;">combineByKey[V]((v: V) =&gt; v, func, func, partitioner)</tspan></tspan></text></g></g><g id="SvgjsG1728"><path id="SvgjsPath1729" d="M1763.6520036768031 192.1129763103475C 1763.6520036768031 231.86918334493112 1842.550318753278 212.80121372020835 1842.550318753278 252.5574207547919" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1730)"></path></g><g id="SvgjsG1732"><path id="SvgjsPath1733" d="M1842.550318753278 307.1402740478514C 1842.550318753278 457.30574726691833 2200.18031398325 271.1510677638355 2200.18031398325 421.3165409829024" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1734)"></path></g><g id="SvgjsG1736" transform="translate(2434.6520036768047,280.55124791528567)"><path id="SvgjsPath1737" d="M 0 0L 132.630024521437 0L 132.630024521437 50.4891738878527L 0 50.4891738878527Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1738"><text id="SvgjsText1739" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="113px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="15.294586943926351" transform="rotate(0)"><tspan id="SvgjsTspan1740" dy="16" x="66.5"><tspan id="SvgjsTspan1741" style="text-decoration:;">map( (_.2,1) )</tspan></tspan></text></g></g><g id="SvgjsG1742"><path id="SvgjsPath1743" d="M2200.18031398325 421.3165409829024C 2200.18031398325 316.7626262318483 2330.0980889257507 305.79583485921205 2434.6520036768047 305.79583485921205" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1744)"></path></g><g id="SvgjsG1746"><path id="SvgjsPath1747" d="M2567.2820281982417 305.79583485921205C 2681.298323506411 305.79583485921205 2827.8644315382066 307.3002456747328 2827.8644315382066 421.3165409829025" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1748)"></path></g><g id="SvgjsG1750"><path id="SvgjsPath1751" d="M2827.8644315382066 421.3165409829025C 2827.8644315382066 262.0727011473821 3065.9826260254827 445.7023352821257 3225.226465861003 445.7023352821257" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1752)"></path></g><g id="SvgjsG1754" transform="translate(3225.226465861003,390.2856686154591)"><path id="SvgjsPath1755" d="M 0 0L 135 0L 135 110.83333333333333L 0 110.83333333333333Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1756"><text id="SvgjsText1757" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="115px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="45.46666666666666" transform="rotate(0)"><tspan id="SvgjsTspan1758" dy="16" x="67.5"><tspan id="SvgjsTspan1759" style="text-decoration:;">foreach(println)</tspan></tspan></text></g></g><g id="SvgjsG1760" transform="translate(3453.2841975952347,392.4156328597448)"><path id="SvgjsPath1761" d="M 0 0L 310.4423903360803 0L 326.4423903360803 16L 326.4423903360803 92.28598048228041L 0 92.28598048228041L 0 0Z" stroke="none" fill-opacity="1" fill="#ffffaa"></path><path id="SvgjsPath1762" d="M 310.4423903360803 0L 310.4423903360803 16L 326.4423903360803 16Z" stroke="none" fill-opacity="1" fill="#cdcdcd"></path><path id="SvgjsPath1763" d="M 0 0L 310.4423903360803 0L 326.4423903360803 16L 326.4423903360803 92.28598048228041L 0 92.28598048228041L 0 0Z" stroke="none" fill="none"></path><g id="SvgjsG1764"><text id="SvgjsText1765" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="307px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="12.192990241140205" transform="rotate(0)"><tspan id="SvgjsTspan1766" dy="16" x="163.5"><tspan id="SvgjsTspan1767" style="text-decoration:;">sc.runJob(this, (iter: Iterator[T]) =&gt; </tspan></tspan><tspan id="SvgjsTspan1768" dy="16" x="163.5"><tspan id="SvgjsTspan1769" style="text-decoration:;">iter.foreach(cleanF))</tspan></tspan><tspan id="SvgjsTspan1770" dy="16" x="163.5"><tspan id="SvgjsTspan1771" style="text-decoration:;">调用foreach这样的收集类算子的时候</tspan></tspan><tspan id="SvgjsTspan1772" dy="16" x="163.5"><tspan id="SvgjsTspan1773" style="text-decoration:;">任务开始真正的跑</tspan></tspan></text></g></g><g id="SvgjsG1774"><path id="SvgjsPath1775" d="M3360.226465861003 445.7023352821257C 3397.559076933359 445.7023352821257 3415.9515865228786 438.558623100885 3453.2841975952347 438.558623100885" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1776)"></path></g><g id="SvgjsG1778" transform="translate(953.7765475177264,24.991685527468903)"><path id="SvgjsPath1779" d="M 0 0L 1783.580207824707 0L 1783.580207824707 43.09399972491701L 0 43.09399972491701Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#33ff99"></path><g id="SvgjsG1780"><text id="SvgjsText1781" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="1764px" fill="#323232" font-weight="400" align="middle" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.596999862458507" transform="rotate(0)"><tspan id="SvgjsTspan1782" dy="16" x="892"><tspan id="SvgjsTspan1783" style="text-decoration:;">SparkContext</tspan></tspan></text></g></g><g id="SvgjsG1784"><path id="SvgjsPath1785" d="M3292.726465861003 390.2856686154591C 3031.4687375272724 390.2856686154591 2998.614483676164 46.53868538992737 2737.3567553424336 46.53868538992741" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1786)"></path><rect id="SvgjsRect1788" width="42" height="16" x="2994.0416106017183" y="210.41217700269323" fill="#ffffff"></rect><text id="SvgjsText1789" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="42px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="208.46217700269324" transform="rotate(0)"><tspan id="SvgjsTspan1790" dy="16" x="3015.0416106017183"><tspan id="SvgjsTspan1791" style="text-decoration:;">runJob</tspan></tspan></text></g><g id="SvgjsG1792"><path id="SvgjsPath1793" d="M953.7765475177264 46.53868538992741C 655.12462832288 46.53868538992741 138.00415039062494 272.19581604003895 300.2708333333333 407.6291681925456" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1794)"></path><rect id="SvgjsRect1796" width="54" height="16" x="427.17921462394685" y="168.2964197340465" fill="#ffffff"></rect><text id="SvgjsText1797" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="54px" fill="#323232" font-weight="400" align="top" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="166.34641973404652" transform="rotate(0)"><tspan id="SvgjsTspan1798" dy="16" x="454.17921462394685"><tspan id="SvgjsTspan1799" style="text-decoration:;">textFile()</tspan></tspan></text></g><g id="SvgjsG1800"><path id="SvgjsPath1801" d="M129.99305555555574 677.0881622928916C 186.4854232898608 677.0881622928916 195.2941544834344 748.5900787345663 251.78652221773945 748.5900787345663" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1802)"></path></g></svg>